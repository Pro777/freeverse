---
import BaseLayout from "../layouts/BaseLayout.astro";
import { loadFeaturedPoem, loadFirstStanza } from "../lib/poems";

const base = import.meta.env.BASE_URL;

const featured = await loadFeaturedPoem();
const featuredStanza = featured ? await loadFirstStanza(featured) : undefined;
---

<BaseLayout
  title="Freeverse"
  description="Public-domain poetry — a clean reader with shareable line links."
  currentPath="/"
>
  <section class="hero">
    <h1>Freeverse</h1>
    <p class="lede">Public-domain poetry. A clean reader. Shareable line links.</p>
  </section>

  <section class="grid">
    <div class="card">
      <div class="kicker">
        <h2>Featured</h2>
        <span class="pill">A small daily delight</span>
      </div>

      {featured ? (
        <>
          <p style="margin: 0.1rem 0 0.1rem;"><strong>{featured.title}</strong></p>
          <p class="muted" style="margin: 0 0 0.6rem;">{featured.author}</p>
          {featuredStanza ? (
            <pre class="poem-preview">{featuredStanza}</pre>
          ) : (
            <p class="muted">(Preview unavailable.)</p>
          )}
          <div class="actions">
            <a class="action primary" href={`${base}browse/`}>Browse all poems</a>
            <a class="action" href="https://github.com/Pro777/freeverse/tree/main/meta">View metadata</a>
          </div>
        </>
      ) : (
        <p class="muted">(No featured poem set.)</p>
      )}
    </div>

    <div class="card">
      <div class="kicker">
        <h2>Browse</h2>
        <span class="pill">By author, title (more soon)</span>
      </div>
      <p class="muted">
        Start with a calm list of what we’ve discovered in <code>meta/*.yml</code>.
      </p>
      <div class="actions">
        <a class="action primary" href={`${base}browse/`}>Open the catalog</a>
        <a class="action" href="https://github.com/Pro777/freeverse">Project repo</a>
      </div>
    </div>
  </section>
</BaseLayout>
